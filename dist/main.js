(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var c=n.getElementsByTagName("script");if(c.length)for(var r=c.length-1;r>-1&&!t;)t=c[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();const t=(()=>{const e={};return{subscribe:function(t,n){e[t]||(e[t]=[]),e[t].push(n)},publish:function(t,n){e[t]&&e[t].forEach((e=>{e(n)}))},unsubscribe:function(t,n){if(e[t])for(let c=0;c<e[t].length;c+=1)if(e[t][c]===n)return e[t].splice(c,1),!0;return!1}}})();(()=>{let e=Array.from({length:3},(()=>new Array(3).fill(".")));t.subscribe("restartGame",(function(){for(let t=0;t<3;t+=1)for(let n=0;n<3;n+=1)e[t][n]="."})),t.subscribe("gridPickedBeforeEnd",(function([n,c]){"."===e[n][c]?t.publish("gridPickedAccepted",[n,c]):t.publish("gridPickedRejected",[n,c])})),t.subscribe("updateGridPicked",(function([n,c,r]){const i=function(e,t,n,c){if(t<0||t>=3||n<0||n>=3)return!1;if("."!==e[t][n])return!1;const r=new Array(3);for(let t=0;t<3;t+=1)r[t]=e[t].slice();return r[t][n]=c,r}(e,n,c,r);e=i,function(){const n=function(e){for(let n=0;n<3;n+=1){const c=e[n][0];if("."!==c)for(let r=1;r<3&&e[n][r]===c;r+=1)if(2===r)return t.publish("winnerDecided",c),c;const r=e[0][n];if("."!==r)for(let c=1;c<3&&e[c][n]===r;c+=1)if(2===c)return t.publish("winnerDecided",r),r}if("."!==e[0][0])for(let n=1;n<3&&e[n][n]===e[0][0];n+=1)if(2===n)return t.publish("winnerDecided",e[0][0]),e[0][0];if("."!==e[0][2])for(let n=1;n<3&&e[n][2-n]===e[0][2];n+=1)if(2===n)return t.publish("winnerDecided",e[0][2]),e[0][2];return!1}(e);!1!==n?t.publish("gameEnded",n):function(e){for(let t=0;t<3;t+=1)for(let n=0;n<3;n+=1)if("."===e[t][n])return!1;return!0}(e)&&t.publish("gameEnded","draw")}()}))})(),(()=>{let e=!0,n=!1;t.subscribe("restartGame",(function(){e||t.publish("turnChanged",null),e=!0,n=!1})),t.subscribe("gridPicked",(function([e,c]){n||t.publish("gridPickedBeforeEnd",[e,c])})),t.subscribe("gridPickedAccepted",(function([n,c]){const r=e?"x":"o";t.publish("updateGridPicked",[n,c,r])})),t.subscribe("updateGridPicked",(function(){e=!e,t.publish("turnChanged",null)})),t.subscribe("gameEnded",(function(){n=!0}))})();const n=e.p+"96d43856a7f63bb75055.png",c=e.p+"89fcdb057fecbfe7b7f3.png";(()=>{function e(e){document.getElementById(e).classList.toggle("active")}function r(e){const{target:t}=e,n=t.parentNode.parentNode;if(n.classList.remove("active"),"result-form"===n.id){const e=document.getElementById("res-img-wrapper");for(;e.firstChild;)e.removeChild(e.lastChild)}}document.getElementById("restart-btn").onclick=()=>{t.publish("restartGame",null),t.publish("popClicked",null)},document.getElementById("play-again-btn").onclick=n=>{e("overlay"),r(n),t.publish("restartGame",null)},document.getElementById("mode-btn").onclick=()=>{e("overlay"),e("mode-form"),t.publish("popClicked",null)};const i=document.getElementById("mute-btn"),o=document.querySelector("#mute-btn>ion-icon");i.onclick=()=>{i.classList.contains("muted")?(o.name="volume-mute-outline",i.classList.remove("muted"),t.publish("playJudgeTree",null)):(o.name="musical-notes-outline",i.classList.add("muted"),t.publish("stopJudgeTree",null))},document.getElementById("info-btn").onclick=()=>{e("overlay"),e("info-form"),t.publish("popClicked",null)},document.querySelectorAll(".form-wrapper>span.icon-close").forEach((t=>{t.onclick=t=>{e("overlay"),r(t)}})),document.querySelectorAll(".cell").forEach((e=>{const n=e;n.onclick=()=>{const e=n.getAttribute("data-r"),c=n.getAttribute("data-c");t.publish("gridPicked",[e,c])}})),t.subscribe("restartGame",(function(){document.querySelectorAll(".cell > img").forEach((e=>{e.parentNode.removeChild(e)}))})),t.subscribe("updateGridPicked",(function([e,t,r]){const i="x"===r?n:c,o=document.createElement("img");o.src=i,document.querySelector(`.cell[data-r="${e}"][data-c="${t}"]`).appendChild(o)})),t.subscribe("gridPickedRejected",(function([e,t]){const n=document.querySelector(`.cell[data-r="${e}"][data-c="${t}"]`);n.classList.add("shake"),function(e,t){let c;return function(...e){clearTimeout(c),c=setTimeout((()=>{(()=>{n.classList.remove("shake")})(...e)}),1e3)}}()()})),t.subscribe("gameEnded",(function(t){const r=document.getElementById("res-img-wrapper"),i=document.getElementById("result-text");if("draw"===t){const e=document.createElement("img"),t=document.createElement("img");e.src=n,t.src=c,r.appendChild(e),r.appendChild(t),i.textContent="DRAW!"}else{const e="x"===t?n:c,o=document.createElement("img");o.src=e,r.appendChild(o),i.textContent="WINNER!"}e("result-form"),e("overlay")}))})(),(()=>{const e=document.querySelector("body"),r=document.createElement("div");function i(){return window.innerWidth/window.innerHeight}function o(e,t){const n=document.createElement("img");return n.src=e,t.forEach((e=>{n.classList.add(e)})),n}function s(e,t,n,c,i){const s=100/n,u=100/c;for(let l=0;l<n;l+=1)for(let n=0;n<c;n+=1){const c=o(e,t);c.style.width=i,c.style.position="absolute",c.style.top=s*l+"%",c.style.left=u*(n+(l%2?.5:0))+"%",r.appendChild(c)}}function u(e,t,n,c,r,i,o){s(e,[...t,"active"],r,i,o),s(n,c,r,i,o)}r.classList.add("background-wrapper"),i()>3/4?u(n,["xImg","active"],c,["oImg"],4,7,"10%"):u(n,["xImg","active"],c,["oImg"],10,4,"20%"),window.addEventListener("resize",(()=>{const e=document.querySelector(".background-wrapper img.xImg").classList.contains("active");!function(){for(;r.lastChild;)r.removeChild(r.firstChild)}(),i()>3/4?e?u(n,["xImg","active"],c,["oImg"],4,7,"10%"):u(c,["oImg","active"],n,["xImg"],4,7,"10%"):e?u(n,["xImg","active"],c,["oImg"],10,4,"20%"):u(c,["oImg","active"],n,["xImg"],10,4,"20%")})),e.appendChild(r),t.subscribe("turnChanged",(function(){const e=document.querySelectorAll(".background-wrapper img.active"),t=document.querySelectorAll(".background-wrapper img:not(.active)");e.forEach((e=>{e.classList.remove("active")})),t.forEach((e=>{e.classList.add("active")}))}))})();const r=e.p+"5fdf4dcbcd5a1c52dacd.wav",i=e.p+"dff640501756d96e994b.wav",o=e.p+"6e58a952e7687ad39b98.wav",s=e.p+"058d32c89d5893f4ade7.mp3";(()=>{const e=document.getElementById("mute-btn");function n(e,t){const n=document.createElement("audio");return n.src=e,n.id=t,n}function c(t){if(e.classList.contains("muted"))return;const n=t;n.currentTime=0,n.play()}const u=n(r,"grass"),l=n(i,"error"),d=n(o,"pop"),a=n(s,"judgeTree");a.volume=.4,a.loop=!0,t.subscribe("updateGridPicked",(()=>c(u))),t.subscribe("gridPickedRejected",(()=>c(l))),t.subscribe("popClicked",(()=>c(d))),t.subscribe("playJudgeTree",(()=>{c(a)})),t.subscribe("stopJudgeTree",(()=>function(e){const t=e;t.pause(),t.currentTime=0}(a)))})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RSxHQUNqQyxNQUFNNEUsRUFBVXhILFNBQVN5RSxjQUFjLFNBR3ZDLE9BRkErQyxFQUFRdEgsSUFBTXFILEVBQ2RDLEVBQVE1RSxHQUFLQSxFQUNONEUsQ0FDVCxDQUVBLFNBQVNDLEVBQVVELEdBQ2pCLEdBQUk5RCxFQUFRWixVQUFVZSxTQUFTLFNBQVUsT0FDekMsTUFBTXBELEVBQUkrRyxFQUNWL0csRUFBRWlILFlBQWMsRUFDaEJqSCxFQUFFa0gsTUFDSixDQVNBLE1BQU1DLEVBQVlOLEVBQWdCTyxFQUFPLFNBQ25DQyxFQUFZUixFQUFnQlMsRUFBTyxTQUNuQ0MsRUFBVVYsRUFBZ0JXLEVBQUssT0FDL0JDLEVBQWdCWixFQUFnQmEsRUFBVyxhQUNqREQsRUFBY0UsT0FBUyxHQUN2QkYsRUFBY0csTUFBTyxFQUdyQjdHLEVBQU9iLFVBQVUsb0JBQW9CLElBQU04RyxFQUFVRyxLQUNyRHBHLEVBQU9iLFVBQVUsc0JBQXNCLElBQU04RyxFQUFVSyxLQUN2RHRHLEVBQU9iLFVBQVUsY0FBYyxJQUFNOEcsRUFBVU8sS0FDL0N4RyxFQUFPYixVQUFVLGlCQUFpQixLQUNoQzhHLEVBQVVTLEVBQWMsSUFFMUIxRyxFQUFPYixVQUFVLGlCQUFpQixJQXJCbEMsU0FBbUI2RyxHQUNqQixNQUFNL0csRUFBSStHLEVBQ1YvRyxFQUFFNkgsUUFDRjdILEVBQUVpSCxZQUFjLENBQ2xCLENBaUJ3Q2EsQ0FBVUwsSUFDbkQsRUF6Q0QsRSIsInNvdXJjZXMiOlsid2VicGFjazovL215LXdlYnBhY2stcHJvamVjdC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9teS13ZWJwYWNrLXByb2plY3Qvd2VicGFjay9ydW50aW1lL2dsb2JhbCIsIndlYnBhY2s6Ly9teS13ZWJwYWNrLXByb2plY3Qvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vbXktd2VicGFjay1wcm9qZWN0Ly4vc3JjL3B1YlN1Yi5qcyIsIndlYnBhY2s6Ly9teS13ZWJwYWNrLXByb2plY3QvLi9zcmMvZ2FtZUJvYXJkLmpzIiwid2VicGFjazovL215LXdlYnBhY2stcHJvamVjdC8uL3NyYy9sb2dpYy5qcyIsIndlYnBhY2s6Ly9teS13ZWJwYWNrLXByb2plY3QvLi9zcmMvdWkuanMiLCJ3ZWJwYWNrOi8vbXktd2VicGFjay1wcm9qZWN0Ly4vc3JjL2JhY2tncm91bmQuanMiLCJ3ZWJwYWNrOi8vbXktd2VicGFjay1wcm9qZWN0Ly4vc3JjL2F1ZGlvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmcgPSAoZnVuY3Rpb24oKSB7XG5cdGlmICh0eXBlb2YgZ2xvYmFsVGhpcyA9PT0gJ29iamVjdCcpIHJldHVybiBnbG9iYWxUaGlzO1xuXHR0cnkge1xuXHRcdHJldHVybiB0aGlzIHx8IG5ldyBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuXHR9IGNhdGNoIChlKSB7XG5cdFx0aWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSByZXR1cm4gd2luZG93O1xuXHR9XG59KSgpOyIsInZhciBzY3JpcHRVcmw7XG5pZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5nLmltcG9ydFNjcmlwdHMpIHNjcmlwdFVybCA9IF9fd2VicGFja19yZXF1aXJlX18uZy5sb2NhdGlvbiArIFwiXCI7XG52YXIgZG9jdW1lbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmcuZG9jdW1lbnQ7XG5pZiAoIXNjcmlwdFVybCAmJiBkb2N1bWVudCkge1xuXHRpZiAoZG9jdW1lbnQuY3VycmVudFNjcmlwdClcblx0XHRzY3JpcHRVcmwgPSBkb2N1bWVudC5jdXJyZW50U2NyaXB0LnNyYztcblx0aWYgKCFzY3JpcHRVcmwpIHtcblx0XHR2YXIgc2NyaXB0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic2NyaXB0XCIpO1xuXHRcdGlmKHNjcmlwdHMubGVuZ3RoKSB7XG5cdFx0XHR2YXIgaSA9IHNjcmlwdHMubGVuZ3RoIC0gMTtcblx0XHRcdHdoaWxlIChpID4gLTEgJiYgIXNjcmlwdFVybCkgc2NyaXB0VXJsID0gc2NyaXB0c1tpLS1dLnNyYztcblx0XHR9XG5cdH1cbn1cbi8vIFdoZW4gc3VwcG9ydGluZyBicm93c2VycyB3aGVyZSBhbiBhdXRvbWF0aWMgcHVibGljUGF0aCBpcyBub3Qgc3VwcG9ydGVkIHlvdSBtdXN0IHNwZWNpZnkgYW4gb3V0cHV0LnB1YmxpY1BhdGggbWFudWFsbHkgdmlhIGNvbmZpZ3VyYXRpb25cbi8vIG9yIHBhc3MgYW4gZW1wdHkgc3RyaW5nIChcIlwiKSBhbmQgc2V0IHRoZSBfX3dlYnBhY2tfcHVibGljX3BhdGhfXyB2YXJpYWJsZSBmcm9tIHlvdXIgY29kZSB0byB1c2UgeW91ciBvd24gbG9naWMuXG5pZiAoIXNjcmlwdFVybCkgdGhyb3cgbmV3IEVycm9yKFwiQXV0b21hdGljIHB1YmxpY1BhdGggaXMgbm90IHN1cHBvcnRlZCBpbiB0aGlzIGJyb3dzZXJcIik7XG5zY3JpcHRVcmwgPSBzY3JpcHRVcmwucmVwbGFjZSgvIy4qJC8sIFwiXCIpLnJlcGxhY2UoL1xcPy4qJC8sIFwiXCIpLnJlcGxhY2UoL1xcL1teXFwvXSskLywgXCIvXCIpO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gc2NyaXB0VXJsOyIsImNvbnN0IHB1YlN1YiA9ICgoKSA9PiB7XHJcbiAgY29uc3QgbWFwID0ge307XHJcblxyXG4gIC8vIE1ldGhvZCBkZWNsYXJhdGlvblxyXG4gIGZ1bmN0aW9uIHN1YnNjcmliZShldmVudCwgZm4pIHtcclxuICAgIGlmICghbWFwW2V2ZW50XSkgbWFwW2V2ZW50XSA9IFtdO1xyXG4gICAgbWFwW2V2ZW50XS5wdXNoKGZuKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHB1Ymxpc2goZXZlbnQsIGRhdGEpIHtcclxuICAgIGlmIChtYXBbZXZlbnRdKSB7XHJcbiAgICAgIG1hcFtldmVudF0uZm9yRWFjaCgoZm4pID0+IHtcclxuICAgICAgICBmbihkYXRhKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiB1bnN1YnNjcmliZShldmVudCwgZm4pIHtcclxuICAgIGlmIChtYXBbZXZlbnRdKSB7XHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWFwW2V2ZW50XS5sZW5ndGg7IGkgKz0gMSkge1xyXG4gICAgICAgIGlmIChtYXBbZXZlbnRdW2ldID09PSBmbikge1xyXG4gICAgICAgICAgbWFwW2V2ZW50XS5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIHJldHVybiB7IHN1YnNjcmliZSwgcHVibGlzaCwgdW5zdWJzY3JpYmUgfTtcclxufSkoKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHB1YlN1YjtcclxuIiwiaW1wb3J0IHB1YlN1YiBmcm9tICcuL3B1YlN1Yic7XHJcblxyXG4oKCkgPT4ge1xyXG4gIGNvbnN0IGxlbiA9IDM7XHJcbiAgbGV0IGJvYXJkTWF0ID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogbGVuIH0sICgpID0+IG5ldyBBcnJheShsZW4pLmZpbGwoJy4nKSk7XHJcblxyXG4gIC8vIE1ldGhvZCBkZWNsYXJhdGlvblxyXG4gIC8vIGZ1bmN0aW9uIGV4cG9zZUdyaWQoKSB7IC8vIElNUFVSRSwgVU5URVNURUQsIEZPUiBERUJVR0dJTkdcclxuICAvLyAgIGxldCBvdXRwdXRTdHIgPSAnJztcclxuICAvLyAgIGJvYXJkTWF0LmZvckVhY2goKHJvdykgPT4ge1xyXG4gIC8vICAgICBvdXRwdXRTdHIgPSBgJHtvdXRwdXRTdHJ9JHtKU09OLnN0cmluZ2lmeShyb3cpfVxcbmA7XHJcbiAgLy8gICB9KTtcclxuICAvLyAgIHJldHVybiBib2FyZE1hdDtcclxuICAvLyB9XHJcblxyXG4gIGZ1bmN0aW9uIGdldFJlc3VsdChtYXQpIHsgLy8gSU1QVVJFLCBQQVNTRUQgV0lUSCBNT0NLIFBVQlNVQlxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkgKz0gMSkge1xyXG4gICAgICAvLyBSb3ctd2lzZVxyXG4gICAgICBjb25zdCByb3dSZWYgPSBtYXRbaV1bMF07XHJcbiAgICAgIGlmIChyb3dSZWYgIT09ICcuJykge1xyXG4gICAgICAgIGZvciAobGV0IGMgPSAxOyBjIDwgbGVuOyBjICs9IDEpIHtcclxuICAgICAgICAgIGlmIChtYXRbaV1bY10gIT09IHJvd1JlZikgYnJlYWs7XHJcbiAgICAgICAgICBpZiAoYyA9PT0gbGVuIC0gMSkge1xyXG4gICAgICAgICAgICBwdWJTdWIucHVibGlzaCgnd2lubmVyRGVjaWRlZCcsIHJvd1JlZik7XHJcbiAgICAgICAgICAgIHJldHVybiByb3dSZWY7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIC8vIENvbHVtbi13aXNlXHJcbiAgICAgIGNvbnN0IGNvbFJlZiA9IG1hdFswXVtpXTtcclxuICAgICAgaWYgKGNvbFJlZiAhPT0gJy4nKSB7XHJcbiAgICAgICAgZm9yIChsZXQgciA9IDE7IHIgPCBsZW47IHIgKz0gMSkge1xyXG4gICAgICAgICAgaWYgKG1hdFtyXVtpXSAhPT0gY29sUmVmKSBicmVhaztcclxuICAgICAgICAgIGlmIChyID09PSBsZW4gLSAxKSB7XHJcbiAgICAgICAgICAgIHB1YlN1Yi5wdWJsaXNoKCd3aW5uZXJEZWNpZGVkJywgY29sUmVmKTtcclxuICAgICAgICAgICAgcmV0dXJuIGNvbFJlZjtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIERpYWdvbmFsc1xyXG4gICAgaWYgKG1hdFswXVswXSAhPT0gJy4nKSB7XHJcbiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgbGVuOyBpICs9IDEpIHtcclxuICAgICAgICBpZiAobWF0W2ldW2ldICE9PSBtYXRbMF1bMF0pIGJyZWFrO1xyXG4gICAgICAgIGlmIChpID09PSBsZW4gLSAxKSB7XHJcbiAgICAgICAgICBwdWJTdWIucHVibGlzaCgnd2lubmVyRGVjaWRlZCcsIG1hdFswXVswXSk7XHJcbiAgICAgICAgICByZXR1cm4gbWF0WzBdWzBdO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKG1hdFswXVtsZW4gLSAxXSAhPT0gJy4nKSB7XHJcbiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgbGVuOyBpICs9IDEpIHtcclxuICAgICAgICBpZiAobWF0W2ldW2xlbiAtIDEgLSBpXSAhPT0gbWF0WzBdW2xlbiAtIDFdKSBicmVhaztcclxuICAgICAgICBpZiAoaSA9PT0gbGVuIC0gMSkge1xyXG4gICAgICAgICAgcHViU3ViLnB1Ymxpc2goJ3dpbm5lckRlY2lkZWQnLCBtYXRbMF1bbGVuIC0gMV0pO1xyXG4gICAgICAgICAgcmV0dXJuIG1hdFswXVtsZW4gLSAxXTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGlzRnVsbChtYXQpIHsgLy8gUFVSRSwgVU5URVNURURcclxuICAgIGZvciAobGV0IHIgPSAwOyByIDwgbGVuOyByICs9IDEpIHtcclxuICAgICAgZm9yIChsZXQgYyA9IDA7IGMgPCBsZW47IGMgKz0gMSkge1xyXG4gICAgICAgIGlmIChtYXRbcl1bY10gPT09ICcuJykgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHBpY2tHcmlkKG1hdCwgciwgYywgc3ltYikge1xyXG4gICAgLy8gSU1QVVJFLCBQQVNTRUQgV0lUSCBNT0NLIFBVQlNVQlxyXG4gICAgaWYgKHIgPCAwIHx8IHIgPj0gbGVuIHx8IGMgPCAwIHx8IGMgPj0gbGVuKSByZXR1cm4gZmFsc2U7XHJcbiAgICBpZiAobWF0W3JdW2NdICE9PSAnLicpIHJldHVybiBmYWxzZTtcclxuICAgIGNvbnN0IG5ld01hdCA9IG5ldyBBcnJheShsZW4pO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkgKz0gMSkge1xyXG4gICAgICBuZXdNYXRbaV0gPSBtYXRbaV0uc2xpY2UoKTtcclxuICAgIH1cclxuICAgIG5ld01hdFtyXVtjXSA9IHN5bWI7XHJcbiAgICByZXR1cm4gbmV3TWF0O1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gcmVzZXQoKSB7XHJcbiAgICAvLyBJTVBVUkUsIFVOVEVTVEVEXHJcbiAgICBmb3IgKGxldCByID0gMDsgciA8IGxlbjsgciArPSAxKSB7XHJcbiAgICAgIGZvciAobGV0IGMgPSAwOyBjIDwgbGVuOyBjICs9IDEpIHtcclxuICAgICAgICBib2FyZE1hdFtyXVtjXSA9ICcuJztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gcHJvY2Vzc09yUmVqZWN0R3JpZFBpY2tlZChbciwgY10pIHsgLy8gSU1QVVJFLCBVTlRFU1RFRFxyXG4gICAgaWYgKGJvYXJkTWF0W3JdW2NdID09PSAnLicpIHB1YlN1Yi5wdWJsaXNoKCdncmlkUGlja2VkQWNjZXB0ZWQnLCBbciwgY10pO1xyXG4gICAgZWxzZSBwdWJTdWIucHVibGlzaCgnZ3JpZFBpY2tlZFJlamVjdGVkJywgW3IsIGNdKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGRlY2lkZUlmRW5kZWQoKSB7IC8vIElNUFVSRSwgVU5URVNURURcclxuICAgIGNvbnN0IHJlcyA9IGdldFJlc3VsdChib2FyZE1hdCk7XHJcbiAgICBpZiAocmVzID09PSBmYWxzZSkge1xyXG4gICAgICBpZiAoaXNGdWxsKGJvYXJkTWF0KSkgcHViU3ViLnB1Ymxpc2goJ2dhbWVFbmRlZCcsICdkcmF3Jyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHB1YlN1Yi5wdWJsaXNoKCdnYW1lRW5kZWQnLCByZXMpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gdXBkYXRlR3JpZChbciwgYywgc3ltYm9sXSkgeyAvLyBJTVBVUkUsIFVOVEVTVEVEXHJcbiAgICBjb25zdCB1cGRhdGVkTWF0cml4ID0gcGlja0dyaWQoYm9hcmRNYXQsIHIsIGMsIHN5bWJvbCk7XHJcbiAgICBib2FyZE1hdCA9IHVwZGF0ZWRNYXRyaXg7XHJcbiAgICBkZWNpZGVJZkVuZGVkKCk7XHJcbiAgfVxyXG5cclxuICAvLyBFdmVudCBzdWJzY3JpcHRpb25cclxuICBwdWJTdWIuc3Vic2NyaWJlKCdyZXN0YXJ0R2FtZScsIHJlc2V0KTtcclxuICBwdWJTdWIuc3Vic2NyaWJlKCdncmlkUGlja2VkQmVmb3JlRW5kJywgcHJvY2Vzc09yUmVqZWN0R3JpZFBpY2tlZCk7XHJcbiAgcHViU3ViLnN1YnNjcmliZSgndXBkYXRlR3JpZFBpY2tlZCcsIHVwZGF0ZUdyaWQpO1xyXG59KSgpO1xyXG4iLCJpbXBvcnQgcHViU3ViIGZyb20gJy4vcHViU3ViJztcclxuXHJcbigoKSA9PiB7XHJcbiAgLy8gTG9naWMgdmFyaWFibGVcclxuICBsZXQgaXNDcm9zc1R1cm4gPSB0cnVlO1xyXG4gIGxldCBpc0dhbWVFbmRlZCA9IGZhbHNlO1xyXG5cclxuICAvLyBNZXRob2QgZGVjbGFyYXRpb25cclxuICAvLyBmdW5jdGlvbiBleHBvc2VJc0Nyb3NzVHVybigpIHsgLy8gSU1QVVJFLCBVTlRFU1RFRCwgRk9FIERFQlVHR0lOR1xyXG4gIC8vICAgcmV0dXJuIGlzQ3Jvc3NUdXJuO1xyXG4gIC8vIH1cclxuXHJcbiAgZnVuY3Rpb24gY2hhbmdlVHVybigpIHsgLy8gSU1QVVJFLCBVTlRFU1RFRFxyXG4gICAgaXNDcm9zc1R1cm4gPSAhaXNDcm9zc1R1cm47XHJcbiAgICBwdWJTdWIucHVibGlzaCgndHVybkNoYW5nZWQnLCBudWxsKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGVuZEdhbWUoKSB7XHJcbiAgICBpc0dhbWVFbmRlZCA9IHRydWU7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiByZXNldCgpIHtcclxuICAgIGlmICghaXNDcm9zc1R1cm4pIHB1YlN1Yi5wdWJsaXNoKCd0dXJuQ2hhbmdlZCcsIG51bGwpO1xyXG4gICAgaXNDcm9zc1R1cm4gPSB0cnVlO1xyXG4gICAgaXNHYW1lRW5kZWQgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHByb2Nlc3NPclJlamVjdEdyaWRQaWNrZWQoW3IsIGNdKSB7XHJcbiAgICBpZiAoIWlzR2FtZUVuZGVkKSBwdWJTdWIucHVibGlzaCgnZ3JpZFBpY2tlZEJlZm9yZUVuZCcsIFtyLCBjXSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiByZXNvbHZlQWNjZXB0ZWRHcmlkUGlja2VkKFtyLCBjXSkge1xyXG4gICAgY29uc3Qgc3ltYm9sID0gaXNDcm9zc1R1cm4gPyAneCcgOiAnbyc7XHJcbiAgICBwdWJTdWIucHVibGlzaCgndXBkYXRlR3JpZFBpY2tlZCcsIFtyLCBjLCBzeW1ib2xdKTtcclxuICB9XHJcblxyXG4gIC8vIEV2ZW50IHN1YnNjcmlwdGlvblxyXG4gIHB1YlN1Yi5zdWJzY3JpYmUoJ3Jlc3RhcnRHYW1lJywgcmVzZXQpO1xyXG4gIHB1YlN1Yi5zdWJzY3JpYmUoJ2dyaWRQaWNrZWQnLCBwcm9jZXNzT3JSZWplY3RHcmlkUGlja2VkKTtcclxuICBwdWJTdWIuc3Vic2NyaWJlKCdncmlkUGlja2VkQWNjZXB0ZWQnLCByZXNvbHZlQWNjZXB0ZWRHcmlkUGlja2VkKTtcclxuICBwdWJTdWIuc3Vic2NyaWJlKCd1cGRhdGVHcmlkUGlja2VkJywgY2hhbmdlVHVybik7XHJcbiAgcHViU3ViLnN1YnNjcmliZSgnZ2FtZUVuZGVkJywgZW5kR2FtZSk7XHJcbn0pKCk7XHJcbiIsImltcG9ydCBwdWJTdWIgZnJvbSAnLi9wdWJTdWInO1xyXG5pbXBvcnQgeFN5bWJvbCBmcm9tICcuL2ltZy94LnBuZyc7XHJcbmltcG9ydCBvU3ltYm9sIGZyb20gJy4vaW1nL28ucG5nJztcclxuXHJcbigoKSA9PiB7XHJcbiAgLy8gTWV0aG9kIGRlY2xhcmF0aW9uXHJcbiAgZnVuY3Rpb24gdG9nZ2xlRWxlbWVudChpZCkge1xyXG4gICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcclxuICAgIGZvcm0uY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJyk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBjbG9zZVBvcHVwKGV2ZW50KSB7XHJcbiAgICBjb25zdCB7IHRhcmdldCB9ID0gZXZlbnQ7XHJcbiAgICBjb25zdCBwYXJlbnQgPSB0YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlO1xyXG4gICAgcGFyZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgaWYgKHBhcmVudC5pZCA9PT0gJ3Jlc3VsdC1mb3JtJykgeyAvLyBOZWVkIHRvIGNsZWFyIHJlc3VsdCBhZGRlZFxyXG4gICAgICBjb25zdCByZXNJbWdXcmFwcGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlcy1pbWctd3JhcHBlcicpO1xyXG4gICAgICB3aGlsZSAocmVzSW1nV3JhcHBlci5maXJzdENoaWxkKSByZXNJbWdXcmFwcGVyLnJlbW92ZUNoaWxkKHJlc0ltZ1dyYXBwZXIubGFzdENoaWxkKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHJlc2V0KCkge1xyXG4gICAgY29uc3QgaW1nUyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jZWxsID4gaW1nJyk7XHJcbiAgICBpbWdTLmZvckVhY2goKGltZykgPT4ge1xyXG4gICAgICBpbWcucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChpbWcpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiB1cGRhdGVHcmlkKFtyLCBjLCBzeW1ib2xdKSB7XHJcbiAgICBjb25zdCBpbWcgPSBzeW1ib2wgPT09ICd4JyA/IHhTeW1ib2wgOiBvU3ltYm9sO1xyXG4gICAgY29uc3QgaW1nTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gICAgaW1nTm9kZS5zcmMgPSBpbWc7XHJcbiAgICBjb25zdCBjZWxsTm9kZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5jZWxsW2RhdGEtcj1cIiR7cn1cIl1bZGF0YS1jPVwiJHtjfVwiXWApO1xyXG4gICAgY2VsbE5vZGUuYXBwZW5kQ2hpbGQoaW1nTm9kZSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBkaXNwbGF5UmVzdWx0KHdpbm5lcikge1xyXG4gICAgY29uc3QgcmVzSW1nV3JhcHBlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXMtaW1nLXdyYXBwZXInKTtcclxuICAgIGNvbnN0IHJlc3VsdFRleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdWx0LXRleHQnKTtcclxuICAgIGlmICh3aW5uZXIgPT09ICdkcmF3Jykge1xyXG4gICAgICBjb25zdCBpbWdOb2RlMSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gICAgICBjb25zdCBpbWdOb2RlMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gICAgICBpbWdOb2RlMS5zcmMgPSB4U3ltYm9sO1xyXG4gICAgICBpbWdOb2RlMi5zcmMgPSBvU3ltYm9sO1xyXG4gICAgICByZXNJbWdXcmFwcGVyLmFwcGVuZENoaWxkKGltZ05vZGUxKTtcclxuICAgICAgcmVzSW1nV3JhcHBlci5hcHBlbmRDaGlsZChpbWdOb2RlMik7XHJcbiAgICAgIHJlc3VsdFRleHQudGV4dENvbnRlbnQgPSAnRFJBVyEnO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc3QgaW1nID0gd2lubmVyID09PSAneCcgPyB4U3ltYm9sIDogb1N5bWJvbDtcclxuICAgICAgY29uc3QgaW1nTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gICAgICBpbWdOb2RlLnNyYyA9IGltZztcclxuICAgICAgcmVzSW1nV3JhcHBlci5hcHBlbmRDaGlsZChpbWdOb2RlKTtcclxuICAgICAgcmVzdWx0VGV4dC50ZXh0Q29udGVudCA9ICdXSU5ORVIhJztcclxuICAgIH1cclxuICAgIHRvZ2dsZUVsZW1lbnQoJ3Jlc3VsdC1mb3JtJyk7XHJcbiAgICB0b2dnbGVFbGVtZW50KCdvdmVybGF5Jyk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBkZWJvdW5jZShmbiwgdCkge1xyXG4gICAgbGV0IHRpbWVJZDtcclxuICAgIHJldHVybiBmdW5jdGlvbiBkZWJvdW5jZWQoLi4uYXJncykge1xyXG4gICAgICBjbGVhclRpbWVvdXQodGltZUlkKTtcclxuICAgICAgdGltZUlkID0gc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgZm4oLi4uYXJncyk7XHJcbiAgICAgIH0sIHQpO1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHNoYWtlQ2VsbChbciwgY10pIHtcclxuICAgIGNvbnN0IGNlbGxOb2RlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmNlbGxbZGF0YS1yPVwiJHtyfVwiXVtkYXRhLWM9XCIke2N9XCJdYCk7XHJcbiAgICBjZWxsTm9kZS5jbGFzc0xpc3QuYWRkKCdzaGFrZScpO1xyXG4gICAgZGVib3VuY2UoKCkgPT4ge1xyXG4gICAgICBjZWxsTm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdzaGFrZScpO1xyXG4gICAgfSwgMTAwMCkoKTtcclxuICB9XHJcblxyXG4gIC8vIENhY2hlIERPTSBhbmQgYmluZCBldmVudHNcclxuICBjb25zdCByZXN0YXJ0R2FtZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXJ0LWJ0bicpO1xyXG4gIHJlc3RhcnRHYW1lQnRuLm9uY2xpY2sgPSAoKSA9PiB7XHJcbiAgICBwdWJTdWIucHVibGlzaCgncmVzdGFydEdhbWUnLCBudWxsKTtcclxuICAgIHB1YlN1Yi5wdWJsaXNoKCdwb3BDbGlja2VkJywgbnVsbCk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgcGxheUFnYWluQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BsYXktYWdhaW4tYnRuJyk7XHJcbiAgcGxheUFnYWluQnRuLm9uY2xpY2sgPSAoZXZlbnQpID0+IHtcclxuICAgIHRvZ2dsZUVsZW1lbnQoJ292ZXJsYXknKTtcclxuICAgIGNsb3NlUG9wdXAoZXZlbnQpO1xyXG4gICAgcHViU3ViLnB1Ymxpc2goJ3Jlc3RhcnRHYW1lJywgbnVsbCk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgbW9kZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RlLWJ0bicpO1xyXG4gIG1vZGVCdG4ub25jbGljayA9ICgpID0+IHtcclxuICAgIHRvZ2dsZUVsZW1lbnQoJ292ZXJsYXknKTtcclxuICAgIHRvZ2dsZUVsZW1lbnQoJ21vZGUtZm9ybScpO1xyXG4gICAgcHViU3ViLnB1Ymxpc2goJ3BvcENsaWNrZWQnLCBudWxsKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBtdXRlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ211dGUtYnRuJyk7XHJcbiAgY29uc3QgbXV0ZUJ0blN5bWIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbXV0ZS1idG4+aW9uLWljb24nKTtcclxuICBtdXRlQnRuLm9uY2xpY2sgPSAoKSA9PiB7XHJcbiAgICBpZiAobXV0ZUJ0bi5jbGFzc0xpc3QuY29udGFpbnMoJ211dGVkJykpIHsgLy8gVW5tdXRlIG5vd1xyXG4gICAgICBtdXRlQnRuU3ltYi5uYW1lID0gJ3ZvbHVtZS1tdXRlLW91dGxpbmUnO1xyXG4gICAgICBtdXRlQnRuLmNsYXNzTGlzdC5yZW1vdmUoJ211dGVkJyk7XHJcbiAgICAgIHB1YlN1Yi5wdWJsaXNoKCdwbGF5SnVkZ2VUcmVlJywgbnVsbCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBtdXRlQnRuU3ltYi5uYW1lID0gJ211c2ljYWwtbm90ZXMtb3V0bGluZSc7IC8vIE11dGUgbm93XHJcbiAgICAgIG11dGVCdG4uY2xhc3NMaXN0LmFkZCgnbXV0ZWQnKTtcclxuICAgICAgcHViU3ViLnB1Ymxpc2goJ3N0b3BKdWRnZVRyZWUnLCBudWxsKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBjb25zdCBpbmZvQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luZm8tYnRuJyk7XHJcbiAgaW5mb0J0bi5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgdG9nZ2xlRWxlbWVudCgnb3ZlcmxheScpO1xyXG4gICAgdG9nZ2xlRWxlbWVudCgnaW5mby1mb3JtJyk7XHJcbiAgICBwdWJTdWIucHVibGlzaCgncG9wQ2xpY2tlZCcsIG51bGwpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGluZm9Dcm9zc0J0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZm9ybS13cmFwcGVyPnNwYW4uaWNvbi1jbG9zZScpO1xyXG4gIGluZm9Dcm9zc0J0bnMuZm9yRWFjaCgoYnRuKSA9PiB7XHJcbiAgICBjb25zdCBvcHQgPSBidG47IC8vIENhbm5vdCBtb2RpZnkgZnVuY3Rpb24gcGFyYW0gZGlyZWN0bHlcclxuICAgIG9wdC5vbmNsaWNrID0gKGV2ZW50KSA9PiB7XHJcbiAgICAgIHRvZ2dsZUVsZW1lbnQoJ292ZXJsYXknKTtcclxuICAgICAgY2xvc2VQb3B1cChldmVudCk7XHJcbiAgICB9O1xyXG4gIH0pO1xyXG5cclxuICBjb25zdCBjZWxscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jZWxsJyk7XHJcbiAgY2VsbHMuZm9yRWFjaCgoY2VsbCkgPT4ge1xyXG4gICAgY29uc3Qgb3B0ID0gY2VsbDtcclxuICAgIG9wdC5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICBjb25zdCByID0gb3B0LmdldEF0dHJpYnV0ZSgnZGF0YS1yJyk7XHJcbiAgICAgIGNvbnN0IGMgPSBvcHQuZ2V0QXR0cmlidXRlKCdkYXRhLWMnKTtcclxuICAgICAgcHViU3ViLnB1Ymxpc2goJ2dyaWRQaWNrZWQnLCBbciwgY10pO1xyXG4gICAgfTtcclxuICB9KTtcclxuXHJcbiAgLy8gRXZlbnQgc3Vic2NyaXB0aW9uXHJcbiAgcHViU3ViLnN1YnNjcmliZSgncmVzdGFydEdhbWUnLCByZXNldCk7XHJcbiAgcHViU3ViLnN1YnNjcmliZSgndXBkYXRlR3JpZFBpY2tlZCcsIHVwZGF0ZUdyaWQpO1xyXG4gIHB1YlN1Yi5zdWJzY3JpYmUoJ2dyaWRQaWNrZWRSZWplY3RlZCcsIHNoYWtlQ2VsbCk7XHJcbiAgcHViU3ViLnN1YnNjcmliZSgnZ2FtZUVuZGVkJywgZGlzcGxheVJlc3VsdCk7XHJcbn0pKCk7XHJcbiIsImltcG9ydCBwdWJTdWIgZnJvbSAnLi9wdWJTdWInO1xyXG5pbXBvcnQgJy4vYmFja2dyb3VuZC5jc3MnO1xyXG5pbXBvcnQgeEltZyBmcm9tICcuL2ltZy94LnBuZyc7XHJcbmltcG9ydCBvSW1nIGZyb20gJy4vaW1nL28ucG5nJztcclxuXHJcbigoKSA9PiB7XHJcbiAgLy8gQ2FjaGUgYW5kIGNyZWF0ZSBET00gbmVlZGVkIGZvciBiYWNrZ3JvdW5kIGhhbmRsaW5nXHJcbiAgY29uc3QgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKTtcclxuXHJcbiAgY29uc3QgYmFja2dyb3VuZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gIGJhY2tncm91bmQuY2xhc3NMaXN0LmFkZCgnYmFja2dyb3VuZC13cmFwcGVyJyk7XHJcblxyXG4gIC8vIE1ldGhvZCBkZWNsYXJhdGlvblxyXG4gIGZ1bmN0aW9uIGdldEFzcGVjdFJhdGlvKCkge1xyXG4gICAgcmV0dXJuIHdpbmRvdy5pbm5lcldpZHRoIC8gd2luZG93LmlubmVySGVpZ2h0O1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gY3JlYXRlSW1nTm9kZShpbWdTcmMsIGNsYXNzTmFtZUxpc3QpIHtcclxuICAgIGNvbnN0IGltZ05vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuICAgIGltZ05vZGUuc3JjID0gaW1nU3JjO1xyXG4gICAgY2xhc3NOYW1lTGlzdC5mb3JFYWNoKChjbGFzc05hbWUpID0+IHtcclxuICAgICAgaW1nTm9kZS5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBpbWdOb2RlO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gaW5zZXJ0TW90aWYoaW1nU3JjLCBjbGFzc05hbWVMaXN0LCByLCBjLCB3aWR0aCkge1xyXG4gICAgLy8gSW5zZXJ0IHIgYnkgYyBtb3RpZnNcclxuICAgIGNvbnN0IHZlcnRpY2FsR2FwID0gMTAwIC8gcjtcclxuICAgIGNvbnN0IGhvcml6b250YWxHYXAgPSAxMDAgLyBjO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByOyBpICs9IDEpIHtcclxuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBjOyBqICs9IDEpIHtcclxuICAgICAgICBjb25zdCBub2RlID0gY3JlYXRlSW1nTm9kZShpbWdTcmMsIGNsYXNzTmFtZUxpc3QpO1xyXG4gICAgICAgIG5vZGUuc3R5bGUud2lkdGggPSB3aWR0aDtcclxuICAgICAgICBub2RlLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcclxuICAgICAgICBub2RlLnN0eWxlLnRvcCA9IGAke3ZlcnRpY2FsR2FwICogaX0lYDtcclxuICAgICAgICBub2RlLnN0eWxlLmxlZnQgPSBgJHtob3Jpem9udGFsR2FwICogKGogKyAoaSAlIDIgPyAwLjUgOiAwKSl9JWA7XHJcbiAgICAgICAgYmFja2dyb3VuZC5hcHBlbmRDaGlsZChub2RlKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gaW5zZXJ0Qm90aE1vdGlmKFxyXG4gICAgYWN0aXZlSW1nU3JjLFxyXG4gICAgYWN0aXZlQ2xhc3NOYW1lTGlzdCxcclxuICAgIGluYWN0aXZlSW1nU3JjLFxyXG4gICAgaW5hY3RpdmVDbGFzc05hbWVMaXN0LFxyXG4gICAgcixcclxuICAgIGMsXHJcbiAgICB3aWR0aCxcclxuICApIHtcclxuICAgIGluc2VydE1vdGlmKGFjdGl2ZUltZ1NyYywgWy4uLmFjdGl2ZUNsYXNzTmFtZUxpc3QsICdhY3RpdmUnXSwgciwgYywgd2lkdGgpO1xyXG4gICAgaW5zZXJ0TW90aWYoaW5hY3RpdmVJbWdTcmMsIGluYWN0aXZlQ2xhc3NOYW1lTGlzdCwgciwgYywgd2lkdGgpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZGVsZXRlTW90aWYoKSB7XHJcbiAgICB3aGlsZSAoYmFja2dyb3VuZC5sYXN0Q2hpbGQpIGJhY2tncm91bmQucmVtb3ZlQ2hpbGQoYmFja2dyb3VuZC5maXJzdENoaWxkKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHN3YXBNb3RpZigpIHtcclxuICAgIGNvbnN0IGFjdGl2ZU5vZGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJhY2tncm91bmQtd3JhcHBlciBpbWcuYWN0aXZlJyk7XHJcbiAgICBjb25zdCBpbmFjdGl2ZU5vZGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJhY2tncm91bmQtd3JhcHBlciBpbWc6bm90KC5hY3RpdmUpJyk7XHJcbiAgICBhY3RpdmVOb2Rlcy5mb3JFYWNoKChub2RlKSA9PiB7IG5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7IH0pO1xyXG4gICAgaW5hY3RpdmVOb2Rlcy5mb3JFYWNoKChub2RlKSA9PiB7IG5vZGUuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7IH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gSW5pdCBhbmQgYmluZCBldmVudHNcclxuICBpZiAoZ2V0QXNwZWN0UmF0aW8oKSA+IDMgLyA0KSB7XHJcbiAgICBpbnNlcnRCb3RoTW90aWYoeEltZywgWyd4SW1nJywgJ2FjdGl2ZSddLCBvSW1nLCBbJ29JbWcnXSwgNCwgNywgJzEwJScpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBpbnNlcnRCb3RoTW90aWYoeEltZywgWyd4SW1nJywgJ2FjdGl2ZSddLCBvSW1nLCBbJ29JbWcnXSwgMTAsIDQsICcyMCUnKTtcclxuICB9XHJcblxyXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCAoKSA9PiB7XHJcbiAgICAvLyBOZWVkIHRvIGdldCB3aGljaCBtb3RpZiBpcyBjdXJyZW50bHkgYWN0aXZlIGZpcnN0XHJcbiAgICBjb25zdCB4SXNBY3RpdmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYmFja2dyb3VuZC13cmFwcGVyIGltZy54SW1nJykuY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKTtcclxuICAgIGRlbGV0ZU1vdGlmKCk7XHJcbiAgICBpZiAoZ2V0QXNwZWN0UmF0aW8oKSA+IDMgLyA0KSB7XHJcbiAgICAgIGlmICh4SXNBY3RpdmUpIHtcclxuICAgICAgICBpbnNlcnRCb3RoTW90aWYoeEltZywgWyd4SW1nJywgJ2FjdGl2ZSddLCBvSW1nLCBbJ29JbWcnXSwgNCwgNywgJzEwJScpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGluc2VydEJvdGhNb3RpZihvSW1nLCBbJ29JbWcnLCAnYWN0aXZlJ10sIHhJbWcsIFsneEltZyddLCA0LCA3LCAnMTAlJyk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAoeElzQWN0aXZlKSB7XHJcbiAgICAgIGluc2VydEJvdGhNb3RpZih4SW1nLCBbJ3hJbWcnLCAnYWN0aXZlJ10sIG9JbWcsIFsnb0ltZyddLCAxMCwgNCwgJzIwJScpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaW5zZXJ0Qm90aE1vdGlmKG9JbWcsIFsnb0ltZycsICdhY3RpdmUnXSwgeEltZywgWyd4SW1nJ10sIDEwLCA0LCAnMjAlJyk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGJvZHkuYXBwZW5kQ2hpbGQoYmFja2dyb3VuZCk7XHJcblxyXG4gIC8vIEV2ZW50IHN1YnNjcmlwdGlvblxyXG4gIHB1YlN1Yi5zdWJzY3JpYmUoJ3R1cm5DaGFuZ2VkJywgc3dhcE1vdGlmKTtcclxufSkoKTtcclxuIiwiaW1wb3J0IHB1YlN1YiBmcm9tICcuL3B1YlN1Yic7XHJcbmltcG9ydCBncmFzcyBmcm9tICcuL2F1ZGlvRC9ncmFzcy53YXYnO1xyXG5pbXBvcnQgZXJyb3IgZnJvbSAnLi9hdWRpb0QvZXJyb3Iud2F2JztcclxuaW1wb3J0IHBvcCBmcm9tICcuL2F1ZGlvRC9wb3Aud2F2JztcclxuaW1wb3J0IGp1ZGdlVHJlZSBmcm9tICcuL2F1ZGlvRC9qdWRnZVRyZWUyLm1wMyc7XHJcblxyXG4oKCkgPT4ge1xyXG4gIC8vIENhY2hlIERPTVxyXG4gIGNvbnN0IG11dGVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbXV0ZS1idG4nKTtcclxuXHJcbiAgLy8gTWV0aG9kIGRlY2xhcmF0aW9uXHJcbiAgZnVuY3Rpb24gY3JlYXRlQXVkaW9Ob2RlKGF1ZGlvU3JjLCBpZCkge1xyXG4gICAgY29uc3QgYXVkTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2F1ZGlvJyk7XHJcbiAgICBhdWROb2RlLnNyYyA9IGF1ZGlvU3JjO1xyXG4gICAgYXVkTm9kZS5pZCA9IGlkO1xyXG4gICAgcmV0dXJuIGF1ZE5vZGU7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBwbGF5U291bmQoYXVkTm9kZSkge1xyXG4gICAgaWYgKG11dGVCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdtdXRlZCcpKSByZXR1cm47XHJcbiAgICBjb25zdCBwID0gYXVkTm9kZTtcclxuICAgIHAuY3VycmVudFRpbWUgPSAwO1xyXG4gICAgcC5wbGF5KCk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBzdG9wU291bmQoYXVkTm9kZSkge1xyXG4gICAgY29uc3QgcCA9IGF1ZE5vZGU7XHJcbiAgICBwLnBhdXNlKCk7XHJcbiAgICBwLmN1cnJlbnRUaW1lID0gMDtcclxuICB9XHJcblxyXG4gIC8vIEluaXQgYXVkaW8gbm9kZVxyXG4gIGNvbnN0IGdyYXNzTm9kZSA9IGNyZWF0ZUF1ZGlvTm9kZShncmFzcywgJ2dyYXNzJyk7XHJcbiAgY29uc3QgZXJyb3JOb2RlID0gY3JlYXRlQXVkaW9Ob2RlKGVycm9yLCAnZXJyb3InKTtcclxuICBjb25zdCBwb3BOb2RlID0gY3JlYXRlQXVkaW9Ob2RlKHBvcCwgJ3BvcCcpO1xyXG4gIGNvbnN0IGp1ZGdlVHJlZU5vZGUgPSBjcmVhdGVBdWRpb05vZGUoanVkZ2VUcmVlLCAnanVkZ2VUcmVlJyk7XHJcbiAganVkZ2VUcmVlTm9kZS52b2x1bWUgPSAwLjQ7XHJcbiAganVkZ2VUcmVlTm9kZS5sb29wID0gdHJ1ZTtcclxuXHJcbiAgLy8gRXZlbnQgc3Vic2NyaXB0aW9uXHJcbiAgcHViU3ViLnN1YnNjcmliZSgndXBkYXRlR3JpZFBpY2tlZCcsICgpID0+IHBsYXlTb3VuZChncmFzc05vZGUpKTtcclxuICBwdWJTdWIuc3Vic2NyaWJlKCdncmlkUGlja2VkUmVqZWN0ZWQnLCAoKSA9PiBwbGF5U291bmQoZXJyb3JOb2RlKSk7XHJcbiAgcHViU3ViLnN1YnNjcmliZSgncG9wQ2xpY2tlZCcsICgpID0+IHBsYXlTb3VuZChwb3BOb2RlKSk7XHJcbiAgcHViU3ViLnN1YnNjcmliZSgncGxheUp1ZGdlVHJlZScsICgpID0+IHtcclxuICAgIHBsYXlTb3VuZChqdWRnZVRyZWVOb2RlKTtcclxuICB9KTtcclxuICBwdWJTdWIuc3Vic2NyaWJlKCdzdG9wSnVkZ2VUcmVlJywgKCkgPT4gc3RvcFNvdW5kKGp1ZGdlVHJlZU5vZGUpKTtcclxufSkoKTtcclxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJnIiwiZ2xvYmFsVGhpcyIsInRoaXMiLCJGdW5jdGlvbiIsImUiLCJ3aW5kb3ciLCJzY3JpcHRVcmwiLCJpbXBvcnRTY3JpcHRzIiwibG9jYXRpb24iLCJkb2N1bWVudCIsImN1cnJlbnRTY3JpcHQiLCJzcmMiLCJzY3JpcHRzIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJsZW5ndGgiLCJpIiwiRXJyb3IiLCJyZXBsYWNlIiwicCIsIm1hcCIsInN1YnNjcmliZSIsImV2ZW50IiwiZm4iLCJwdXNoIiwicHVibGlzaCIsImRhdGEiLCJmb3JFYWNoIiwidW5zdWJzY3JpYmUiLCJzcGxpY2UiLCJib2FyZE1hdCIsIkFycmF5IiwiZnJvbSIsImZpbGwiLCJwdWJTdWIiLCJyIiwiYyIsInN5bWJvbCIsInVwZGF0ZWRNYXRyaXgiLCJtYXQiLCJzeW1iIiwibmV3TWF0Iiwic2xpY2UiLCJwaWNrR3JpZCIsInJlcyIsInJvd1JlZiIsImxlbiIsImNvbFJlZiIsImdldFJlc3VsdCIsImlzRnVsbCIsImRlY2lkZUlmRW5kZWQiLCJpc0Nyb3NzVHVybiIsImlzR2FtZUVuZGVkIiwidG9nZ2xlRWxlbWVudCIsImlkIiwiZ2V0RWxlbWVudEJ5SWQiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJjbG9zZVBvcHVwIiwidGFyZ2V0IiwicGFyZW50IiwicGFyZW50Tm9kZSIsInJlbW92ZSIsInJlc0ltZ1dyYXBwZXIiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJsYXN0Q2hpbGQiLCJvbmNsaWNrIiwibXV0ZUJ0biIsIm11dGVCdG5TeW1iIiwicXVlcnlTZWxlY3RvciIsImNvbnRhaW5zIiwibmFtZSIsImFkZCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJidG4iLCJjZWxsIiwib3B0IiwiZ2V0QXR0cmlidXRlIiwiaW1nIiwieFN5bWJvbCIsIm9TeW1ib2wiLCJpbWdOb2RlIiwiY3JlYXRlRWxlbWVudCIsImFwcGVuZENoaWxkIiwiY2VsbE5vZGUiLCJ0IiwidGltZUlkIiwiYXJncyIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJkZWJvdW5jZSIsIndpbm5lciIsInJlc3VsdFRleHQiLCJpbWdOb2RlMSIsImltZ05vZGUyIiwidGV4dENvbnRlbnQiLCJib2R5IiwiYmFja2dyb3VuZCIsImdldEFzcGVjdFJhdGlvIiwiaW5uZXJXaWR0aCIsImlubmVySGVpZ2h0IiwiY3JlYXRlSW1nTm9kZSIsImltZ1NyYyIsImNsYXNzTmFtZUxpc3QiLCJjbGFzc05hbWUiLCJpbnNlcnRNb3RpZiIsIndpZHRoIiwidmVydGljYWxHYXAiLCJob3Jpem9udGFsR2FwIiwiaiIsIm5vZGUiLCJzdHlsZSIsInBvc2l0aW9uIiwidG9wIiwibGVmdCIsImluc2VydEJvdGhNb3RpZiIsImFjdGl2ZUltZ1NyYyIsImFjdGl2ZUNsYXNzTmFtZUxpc3QiLCJpbmFjdGl2ZUltZ1NyYyIsImluYWN0aXZlQ2xhc3NOYW1lTGlzdCIsInhJbWciLCJvSW1nIiwiYWRkRXZlbnRMaXN0ZW5lciIsInhJc0FjdGl2ZSIsImRlbGV0ZU1vdGlmIiwiYWN0aXZlTm9kZXMiLCJpbmFjdGl2ZU5vZGVzIiwiY3JlYXRlQXVkaW9Ob2RlIiwiYXVkaW9TcmMiLCJhdWROb2RlIiwicGxheVNvdW5kIiwiY3VycmVudFRpbWUiLCJwbGF5IiwiZ3Jhc3NOb2RlIiwiZ3Jhc3MiLCJlcnJvck5vZGUiLCJlcnJvciIsInBvcE5vZGUiLCJwb3AiLCJqdWRnZVRyZWVOb2RlIiwianVkZ2VUcmVlIiwidm9sdW1lIiwibG9vcCIsInBhdXNlIiwic3RvcFNvdW5kIl0sInNvdXJjZVJvb3QiOiIifQ==